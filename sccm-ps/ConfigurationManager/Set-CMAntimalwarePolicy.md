---
external help file: AdminUI.PS.dll-Help.xml
Module Name: ConfigurationManager
ms.date: 08/03/2021
schema: 2.0.0
title: Set-CMAntimalwarePolicy
---

# Set-CMAntimalwarePolicy

## SYNOPSIS

Configure settings for an endpoint protection antimalware policy.

## SYNTAX

### SetByName (Default)
```
Set-CMAntimalwarePolicy [-Description <String>] -Name <String> [-NewName <String>] [-PassThru]
 [-Priority <PriorityChangeType>] [-DisableWildcardHandling] [-ForceWildcardHandling] [-WhatIf] [-Confirm]
 [<CommonParameters>]
```

### SetDefinitionUpdatesSettingsByName
```
Set-CMAntimalwarePolicy [-AddDefinitionUpdateFileShare <String[]>] [-CleanDefinitionUpdateFileShare]
 [-DefinitionUpdateFileShare <String[]>] [-EnableSignatureUpdateCatchup <Boolean>]
 [-FallbackOrder <FallbackOrderType[]>] [-FallbackToAlternateSourceHr <Int32>] -Name <String> [-PassThru]
 [-RemoveDefinitionUpdateFileShare <String[]>] [-SignatureUpdateHr <Int32>] [-SignatureUpdateTime <DateTime>]
 [-DisableWildcardHandling] [-ForceWildcardHandling] [-WhatIf] [-Confirm] [<CommonParameters>]
```

### SetDefinitionUpdatesSettingsByValue
```
Set-CMAntimalwarePolicy [-AddDefinitionUpdateFileShare <String[]>] [-CleanDefinitionUpdateFileShare]
 [-DefinitionUpdateFileShare <String[]>] [-EnableSignatureUpdateCatchup <Boolean>]
 [-FallbackOrder <FallbackOrderType[]>] [-FallbackToAlternateSourceHr <Int32>] -InputObject <IResultObject>
 [-PassThru] [-RemoveDefinitionUpdateFileShare <String[]>] [-SignatureUpdateHr <Int32>]
 [-SignatureUpdateTime <DateTime>] [-DisableWildcardHandling] [-ForceWildcardHandling] [-WhatIf] [-Confirm]
 [<CommonParameters>]
```

### SetExclusionSettingsByName
```
Set-CMAntimalwarePolicy [-AddExcludedFilePath <String[]>] [-AddExcludedFileType <String[]>]
 [-AddExcludedProcess <String[]>] [-CleanExcludedFilePath] [-CleanExcludedFileType] [-CleanExcludedProcess]
 [-ExcludeFilePath <String[]>] [-ExcludeFileType <String[]>] [-ExcludeProcess <String[]>] -Name <String>
 [-PassThru] [-RemoveExcludedFilePath <String[]>] [-RemoveExcludedFileType <String[]>]
 [-RemoveExcludedProcess <String[]>] [-DisableWildcardHandling] [-ForceWildcardHandling] [-WhatIf] [-Confirm]
 [<CommonParameters>]
```

### SetExclusionSettingsByValue
```
Set-CMAntimalwarePolicy [-AddExcludedFilePath <String[]>] [-AddExcludedFileType <String[]>]
 [-AddExcludedProcess <String[]>] [-CleanExcludedFilePath] [-CleanExcludedFileType] [-CleanExcludedProcess]
 [-ExcludeFilePath <String[]>] [-ExcludeFileType <String[]>] [-ExcludeProcess <String[]>]
 -InputObject <IResultObject> [-PassThru] [-RemoveExcludedFilePath <String[]>]
 [-RemoveExcludedFileType <String[]>] [-RemoveExcludedProcess <String[]>] [-DisableWildcardHandling]
 [-ForceWildcardHandling] [-WhatIf] [-Confirm] [<CommonParameters>]
```

### SetThreatOverridesSettingsByName
```
Set-CMAntimalwarePolicy [-AddThreat <Hashtable>] [-CleanThreat] -Name <String>
 [-OverrideAction <DefaultActionMediumAndLowType[]>] [-PassThru] [-RemoveThreat <String[]>]
 [-ThreatName <String[]>] [-DisableWildcardHandling] [-ForceWildcardHandling] [-WhatIf] [-Confirm]
 [<CommonParameters>]
```

### SetThreatOverridesSettingsByValue
```
Set-CMAntimalwarePolicy [-AddThreat <Hashtable>] [-CleanThreat] -InputObject <IResultObject>
 [-OverrideAction <DefaultActionMediumAndLowType[]>] [-PassThru] [-RemoveThreat <String[]>]
 [-ThreatName <String[]>] [-DisableWildcardHandling] [-ForceWildcardHandling] [-WhatIf] [-Confirm]
 [<CommonParameters>]
```

### SetScanSettingsByName
```
Set-CMAntimalwarePolicy [-AllowClientUserConfigLimitCpuUsage <Boolean>] [-FullScanNetworkDrive <Boolean>]
 -Name <String> [-PassThru] [-ScanArchive <Boolean>] [-ScanEmail <Boolean>] [-ScanNetworkDrive <Boolean>]
 [-ScanRemovableStorage <Boolean>] [-ScheduledScanUserControl <ScheduledScanUserControlType>]
 [-DisableWildcardHandling] [-ForceWildcardHandling] [-WhatIf] [-Confirm] [<CommonParameters>]
```

### SetScanSettingsByValue
```
Set-CMAntimalwarePolicy [-AllowClientUserConfigLimitCpuUsage <Boolean>] [-FullScanNetworkDrive <Boolean>]
 -InputObject <IResultObject> [-PassThru] [-ScanArchive <Boolean>] [-ScanEmail <Boolean>]
 [-ScanNetworkDrive <Boolean>] [-ScanRemovableStorage <Boolean>]
 [-ScheduledScanUserControl <ScheduledScanUserControlType>] [-DisableWildcardHandling] [-ForceWildcardHandling]
 [-WhatIf] [-Confirm] [<CommonParameters>]
```

### SetRealtimeProtectionSettingsByName
```
Set-CMAntimalwarePolicy [-AllowClientUserConfigRealTime <Boolean>] [-EnablePuaProtection <Boolean>]
 [-PuaProtection <PuaProtection>] [-EnableScriptScanning <Boolean>] [-MonitorFileProgramActivity <Boolean>]
 -Name <String> [-NetworkExploitProtection <Boolean>] [-PassThru] [-RealTimeProtectionOn <Boolean>]
 [-RealTimeScanOption <RealTimeScanOptionType>] [-ScanAllDownloaded <Boolean>] [-UseBehaviorMonitor <Boolean>]
 [-DisableWildcardHandling] [-ForceWildcardHandling] [-WhatIf] [-Confirm] [<CommonParameters>]
```

### SetRealtimeProtectionSettingsByValue
```
Set-CMAntimalwarePolicy [-AllowClientUserConfigRealTime <Boolean>] [-EnablePuaProtection <Boolean>]
 [-PuaProtection <PuaProtection>] [-EnableScriptScanning <Boolean>] -InputObject <IResultObject>
 [-MonitorFileProgramActivity <Boolean>] [-NetworkExploitProtection <Boolean>] [-PassThru]
 [-RealTimeProtectionOn <Boolean>] [-RealTimeScanOption <RealTimeScanOptionType>]
 [-ScanAllDownloaded <Boolean>] [-UseBehaviorMonitor <Boolean>] [-DisableWildcardHandling]
 [-ForceWildcardHandling] [-WhatIf] [-Confirm] [<CommonParameters>]
```

### SetAdvancedSettingsByName
```
Set-CMAntimalwarePolicy [-AllowClientUserConfigSampleSubmission <Boolean>]
 [-AllowDeleteQuarantineFileDaysModification <Boolean>] [-AllowExclusionModification <Boolean>]
 [-AllowUserViewHistory <Boolean>] [-CreateSystemRestorePointBeforeClean <Boolean>]
 [-DeleteQuarantineFileDays <Int32>] [-DisableClientUI <Boolean>] [-EnableAutoSampleSubmission <Boolean>]
 [-EnableReparsePointScanning <Boolean>] -Name <String> [-PassThru]
 [-RandomizeScheduledScanStartTime <Boolean>] [-ShowNotification <Boolean>] [-DisableWildcardHandling]
 [-ForceWildcardHandling] [-WhatIf] [-Confirm] [<CommonParameters>]
```

### SetAdvancedSettingsByValue
```
Set-CMAntimalwarePolicy [-AllowClientUserConfigSampleSubmission <Boolean>]
 [-AllowDeleteQuarantineFileDaysModification <Boolean>] [-AllowExclusionModification <Boolean>]
 [-AllowUserViewHistory <Boolean>] [-CreateSystemRestorePointBeforeClean <Boolean>]
 [-DeleteQuarantineFileDays <Int32>] [-DisableClientUI <Boolean>] [-EnableAutoSampleSubmission <Boolean>]
 [-EnableReparsePointScanning <Boolean>] -InputObject <IResultObject> [-PassThru]
 [-RandomizeScheduledScanStartTime <Boolean>] [-ShowNotification <Boolean>] [-DisableWildcardHandling]
 [-ForceWildcardHandling] [-WhatIf] [-Confirm] [<CommonParameters>]
```

### SetMAPSSettingsByName
```
Set-CMAntimalwarePolicy [-AllowMapsModification <Boolean>] [-CloudBlockLevel <CloudBlockLevelType>]
 [-ExtendedCloudCheckSec <Int32>] [-JoinSpyNet <JoinSpyNetType>] -Name <String> [-PassThru]
 [-DisableWildcardHandling] [-ForceWildcardHandling] [-WhatIf] [-Confirm] [<CommonParameters>]
```

### SetMAPSSettingsByValue
```
Set-CMAntimalwarePolicy [-AllowMapsModification <Boolean>] [-CloudBlockLevel <CloudBlockLevelType>]
 [-ExtendedCloudCheckSec <Int32>] -InputObject <IResultObject> [-JoinSpyNet <JoinSpyNetType>] [-PassThru]
 [-DisableWildcardHandling] [-ForceWildcardHandling] [-WhatIf] [-Confirm] [<CommonParameters>]
```

### SetScheduledScanSettingsByName
```
Set-CMAntimalwarePolicy [-CheckLatestDefinition <Boolean>] [-EnableCatchupScan <Boolean>]
 [-EnableQuickScan <Boolean>] [-EnableScheduledScan <Boolean>] [-LimitCpuUsage <Int32>] -Name <String>
 [-PassThru] [-QuickScanTime <DateTime>] [-ScanWhenClientNotInUse <Boolean>] [-ScheduledScanTime <DateTime>]
 [-ScheduledScanType <ScheduledScanType>] [-ScheduledScanWeekday <ScheduledScanWeekdayType>]
 [-DisableWildcardHandling] [-ForceWildcardHandling] [-WhatIf] [-Confirm] [<CommonParameters>]
```

### SetScheduledScanSettingsByValue
```
Set-CMAntimalwarePolicy [-CheckLatestDefinition <Boolean>] [-EnableCatchupScan <Boolean>]
 [-EnableQuickScan <Boolean>] [-EnableScheduledScan <Boolean>] -InputObject <IResultObject>
 [-LimitCpuUsage <Int32>] [-PassThru] [-QuickScanTime <DateTime>] [-ScanWhenClientNotInUse <Boolean>]
 [-ScheduledScanTime <DateTime>] [-ScheduledScanType <ScheduledScanType>]
 [-ScheduledScanWeekday <ScheduledScanWeekdayType>] [-DisableWildcardHandling] [-ForceWildcardHandling]
 [-WhatIf] [-Confirm] [<CommonParameters>]
```

### SetDefaultActionSettingsByName
```
Set-CMAntimalwarePolicy [-DefaultActionHigh <DefaultActionSevereAndHighType>]
 [-DefaultActionLow <DefaultActionMediumAndLowType>] [-DefaultActionMedium <DefaultActionMediumAndLowType>]
 [-DefaultActionSevere <DefaultActionSevereAndHighType>] -Name <String> [-PassThru] [-DisableWildcardHandling]
 [-ForceWildcardHandling] [-WhatIf] [-Confirm] [<CommonParameters>]
```

### SetDefaultActionSettingsByValue
```
Set-CMAntimalwarePolicy [-DefaultActionHigh <DefaultActionSevereAndHighType>]
 [-DefaultActionLow <DefaultActionMediumAndLowType>] [-DefaultActionMedium <DefaultActionMediumAndLowType>]
 [-DefaultActionSevere <DefaultActionSevereAndHighType>] -InputObject <IResultObject> [-PassThru]
 [-DisableWildcardHandling] [-ForceWildcardHandling] [-WhatIf] [-Confirm] [<CommonParameters>]
```

### SetByValue
```
Set-CMAntimalwarePolicy [-Description <String>] -InputObject <IResultObject> [-NewName <String>] [-PassThru]
 [-Priority <PriorityChangeType>] [-DisableWildcardHandling] [-ForceWildcardHandling] [-WhatIf] [-Confirm]
 [<CommonParameters>]
```

## DESCRIPTION

The **Set-CMAntiMalwarePolicy** cmdlet configures settings for an endpoint protection antimalware policy.

First use [New-CMAntimalwarePolicy](New-CMAntimalwarePolicy.md) to create the policy object. When you create the policy, use the **Policy** parameter to specify which types of settings the policy includes. If you use **Set-CMAntiMalwarePolicy** to configure settings for policy types that weren't originally added, it adds the types when you configure the settings.

For more information, see [How to create and deploy antimalware policies for Endpoint Protection in Configuration Manager](/mem/configmgr/protect/deploy-use/endpoint-antimalware-policies).

> [!NOTE]
> Run Configuration Manager cmdlets from the Configuration Manager site drive, for example `PS XYZ:\>`. For more information, see [getting started](/powershell/sccm/overview).

## EXAMPLES

### Example 1: Create an antimalware policy and enable PUA auditing

In this example, it first creates a new antimalware policy that includes the **RealTimeProtection** settings type. It then configures that policy to enable auditing for potentially unwanted applications (PUA).

```powershell
$polName = "Real-time protection policy"
$polDesc = "via Pwsh by " + $env:UserName + " at " + $(Get-Date)
New-CMAntimalwarePolicy -Name $polName -Description $polDesc -Policy RealTimeProtection

Set-CMAntimalwarePolicy -Name $polName -PuaProtection Audit
```

### Example 2: Increase the priority of an antimalware policy

This command increases the priority of the antimalware policy named **ContosoPolicy**.

```powershell
Set-CMAntiMalwarePolicy -Name "ContosoPolicy" -Priority Increase
```

## PARAMETERS

### -AddDefinitionUpdateFileShare

If you select UNC file shares as a security intelligence update source, use this parameter to add more network paths to the list.

```yaml
Type: String[]
Parameter Sets: SetDefinitionUpdatesSettingsByName, SetDefinitionUpdatesSettingsByValue
Aliases: AddDefinitionUpdateFileSharesSources, AddDefinitionUpdateFileShares

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -AddExcludedFilePath

Specify a file or folder path to exclude from antimalware scans. Exclusions can help scans complete faster or avoid conflicts with some applications. It can also increase the malware risk.

Use this parameter to add more paths to the list.

For example: `%windir%\explorer.exe`, `%windir%\system32`

```yaml
Type: String[]
Parameter Sets: SetExclusionSettingsByName, SetExclusionSettingsByValue
Aliases: AddExcludedFilePaths

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -AddExcludedFileType

Specify a file extension to exclude all files of this type from antimalware scans. Exclusions can help scans complete faster or avoid conflicts with some applications. It can also increase the malware risk.

Use this parameter to add more types to the list.

For example: `.jpg`, `.txt`

```yaml
Type: String[]
Parameter Sets: SetExclusionSettingsByName, SetExclusionSettingsByValue
Aliases: AddExcludedFileTypes

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -AddExcludedProcess

Specify the path to a process executable file to exclude it from antimalware scans. Exclusions can help scans complete faster or avoid conflicts with some applications. It can also increase the malware risk.

Use this parameter to add more processes to the list.

For example: `%windir%\system32\service.exe`

```yaml
Type: String[]
Parameter Sets: SetExclusionSettingsByName, SetExclusionSettingsByValue
Aliases: AddExcludedProcesses

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -AddThreat

Specify a hashtable of threat names and corresponding override action. This table defines remediation actions to take when the specified threat name is detected during a scan.

Use this parameter to add more threats to the list.

```yaml
Type: Hashtable
Parameter Sets: SetThreatOverridesSettingsByName, SetThreatOverridesSettingsByValue
Aliases: AddThreats

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -AllowClientUserConfigLimitCpuUsage

Set this parameter to `$true` to allow users on client computers to configure CPU usage during scans.

```yaml
Type: Boolean
Parameter Sets: SetScanSettingsByName, SetScanSettingsByValue
Aliases:

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -AllowClientUserConfigRealTime

Set this parameter to `$true` to allow users on client computers to configure real-time protection settings.

```yaml
Type: Boolean
Parameter Sets: SetRealtimeProtectionSettingsByName, SetRealtimeProtectionSettingsByValue
Aliases:

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -AllowClientUserConfigSampleSubmission

Set this parameter to `$true` to allow users on client computers to modify auto sample file submission settings.

```yaml
Type: Boolean
Parameter Sets: SetAdvancedSettingsByName, SetAdvancedSettingsByValue
Aliases:

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -AllowDeleteQuarantineFileDaysModification

Set this parameter to `$true` to allow users on client computers to configure the setting for quarantined file deletion.

```yaml
Type: Boolean
Parameter Sets: SetAdvancedSettingsByName, SetAdvancedSettingsByValue
Aliases: AllowUserConfigQuarantinedFileDeletionPeriod

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -AllowExclusionModification

Set this parameter to `$true` to allow users on client computers to exclude files and folders, file types, and processes from scans.

```yaml
Type: Boolean
Parameter Sets: SetAdvancedSettingsByName, SetAdvancedSettingsByValue
Aliases: AllowUserAddExcludes

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -AllowMapsModification

Set this parameter to `$true` to allow users on client computers to modify Cloud Protection Service settings.

```yaml
Type: Boolean
Parameter Sets: SetMAPSSettingsByName, SetMAPSSettingsByValue
Aliases: AllowUserChangeSpyNetSettings

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -AllowUserViewHistory

Set this parameter to `$true` to allow all users on client computers to view the full history results.

```yaml
Type: Boolean
Parameter Sets: SetAdvancedSettingsByName, SetAdvancedSettingsByValue
Aliases:

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -CheckLatestDefinition

Set this parameter to `$true` to check for the latest security intelligence updates before running a scan.

```yaml
Type: Boolean
Parameter Sets: SetScheduledScanSettingsByName, SetScheduledScanSettingsByValue
Aliases:

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -CleanDefinitionUpdateFileShare

Add this parameter to remove the list of network file shares to use as security intelligence update sources.

```yaml
Type: SwitchParameter
Parameter Sets: SetDefinitionUpdatesSettingsByName, SetDefinitionUpdatesSettingsByValue
Aliases:

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -CleanExcludedFilePath

Add this parameter to remove the list of file paths to exclude from scans.

```yaml
Type: SwitchParameter
Parameter Sets: SetExclusionSettingsByName, SetExclusionSettingsByValue
Aliases:

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -CleanExcludedFileType

Add this parameter to remove the list of file extensions to exclude from scans.

```yaml
Type: SwitchParameter
Parameter Sets: SetExclusionSettingsByName, SetExclusionSettingsByValue
Aliases:

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -CleanExcludedProcess

Add this parameter to remove the list of processes to exclude from scans.

```yaml
Type: SwitchParameter
Parameter Sets: SetExclusionSettingsByName, SetExclusionSettingsByValue
Aliases:

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -CleanThreat

Add this parameter to remove the table of predefined remediation actions for detected threat names.

```yaml
Type: SwitchParameter
Parameter Sets: SetThreatOverridesSettingsByName, SetThreatOverridesSettingsByValue
Aliases: CleanThreats

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -CloudBlockLevel

For the Cloud Protection Service, specify the level of blocking suspicious files.

```yaml
Type: CloudBlockLevelType
Parameter Sets: SetMAPSSettingsByName, SetMAPSSettingsByValue
Aliases:
Accepted values: Normal, High, HighExtraProtection, BlockUnknown

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -CreateSystemRestorePointBeforeClean

Set this parameter to `$true` to create a system restore point before computers are cleaned.

```yaml
Type: Boolean
Parameter Sets: SetAdvancedSettingsByName, SetAdvancedSettingsByValue
Aliases:

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -DefaultActionHigh

Specify the default action that endpoint protection takes in response to a threat it classifies at the **High** level.

```yaml
Type: DefaultActionSevereAndHighType
Parameter Sets: SetDefaultActionSettingsByName, SetDefaultActionSettingsByValue
Aliases:
Accepted values: Recommended, Quarantine, Remove

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -DefaultActionLow

Specify the default action that endpoint protection takes in response to a threat it classifies at the **Low** level.

```yaml
Type: DefaultActionMediumAndLowType
Parameter Sets: SetDefaultActionSettingsByName, SetDefaultActionSettingsByValue
Aliases:
Accepted values: None, Quarantine, Remove, Allow

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -DefaultActionMedium

Specify the default action that endpoint protection takes in response to a threat it classifies at the **Medium** level.

```yaml
Type: DefaultActionMediumAndLowType
Parameter Sets: SetDefaultActionSettingsByName, SetDefaultActionSettingsByValue
Aliases:
Accepted values: None, Quarantine, Remove, Allow

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -DefaultActionSevere

Specify the default action that endpoint protection takes in response to a threat it classifies at the **Severe** level.

```yaml
Type: DefaultActionSevereAndHighType
Parameter Sets: SetDefaultActionSettingsByName, SetDefaultActionSettingsByValue
Aliases:
Accepted values: Recommended, Quarantine, Remove

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -DefinitionUpdateFileShare

Specify an array of UNC file share sources used to download security intelligence updates. Sources are contacted in the order specified.

If you specify this parameter, the client contacts the provided resources for updates.
Once the client successfully downloads updates from one source, it doesn't contact the remaining sources in the list.
If you don't specify this parameter, the list remains empty and no sources are contacted.

```yaml
Type: String[]
Parameter Sets: SetDefinitionUpdatesSettingsByName, SetDefinitionUpdatesSettingsByValue
Aliases: DefinitionUpdateFileSharesSources, DefinitionUpdateFileShares

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -DeleteQuarantineFileDays

Specify the number of days that items should be kept in the Quarantine folder before being removed.

If you specify this parameter, items are removed from the Quarantine folder after the specified number of days.
If you don't specify this parameter, items are kept in the Quarantine folder for the number of days specified in the default policy, which is 30 days.

```yaml
Type: Int32
Parameter Sets: SetAdvancedSettingsByName, SetAdvancedSettingsByValue
Aliases: DeleteQuarantinedFilesPeriod

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -Description

Specify an optional description for the antimalware policy to help you identify it.

```yaml
Type: String
Parameter Sets: SetByName, SetByValue
Aliases:

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -DisableClientUI

Set this parameter to `$true` to disable the client user interface.

```yaml
Type: Boolean
Parameter Sets: SetAdvancedSettingsByName, SetAdvancedSettingsByValue
Aliases:

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -DisableWildcardHandling

This parameter treats wildcard characters as literal character values. You can't combine it with **ForceWildcardHandling**.

```yaml
Type: SwitchParameter
Parameter Sets: (All)
Aliases:

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -EnableAutoSampleSubmission

Set this parameter to `$true` to enable auto sample file submission. This feature helps Microsoft determine whether certain detected items are malicious.

```yaml
Type: Boolean
Parameter Sets: SetAdvancedSettingsByName, SetAdvancedSettingsByValue
Aliases:

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -EnableCatchupScan

Set this parameter to `$true` to force a scan of the selected scan type if a client computer is offline during two or more scheduled scans.

```yaml
Type: Boolean
Parameter Sets: SetScheduledScanSettingsByName, SetScheduledScanSettingsByValue
Aliases:

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -EnablePuaProtection

In version 2103 or earlier, set this parameter to `$true` to enable detection for potentially unwanted applications (PUA).

Starting in version 2107, use the **PuaProtection** parameter to configure this setting.

```yaml
Type: Boolean
Parameter Sets: SetRealtimeProtectionSettingsByName, SetRealtimeProtectionSettingsByValue
Aliases:

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -EnableQuickScan

Set this parameter to `$true` to run a daily quick scan on client computers.

```yaml
Type: Boolean
Parameter Sets: SetScheduledScanSettingsByName, SetScheduledScanSettingsByValue
Aliases: EnableQuickDailyScan

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -EnableReparsePointScanning

Set this parameter to `$true` to enable reparse point scanning.

```yaml
Type: Boolean
Parameter Sets: SetAdvancedSettingsByName, SetAdvancedSettingsByValue
Aliases:

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -EnableScheduledScan

Set this parameter to `$true` to configure this policy to run a scheduled scan on client computers.

```yaml
Type: Boolean
Parameter Sets: SetScheduledScanSettingsByName, SetScheduledScanSettingsByValue
Aliases:

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -EnableScriptScanning

Set this parameter to `$true` to enable script scanning.

```yaml
Type: Boolean
Parameter Sets: SetRealtimeProtectionSettingsByName, SetRealtimeProtectionSettingsByValue
Aliases:

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -EnableSignatureUpdateCatchup

Set this parameter to `$true` to force a security intelligence update if the client computer is offline for more than two consecutive scheduled updates.

```yaml
Type: Boolean
Parameter Sets: SetDefinitionUpdatesSettingsByName, SetDefinitionUpdatesSettingsByValue
Aliases: EnableSignatureUpdateCatchupInterval

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -ExcludeFilePath

Specify an array of file paths for which scheduled and real-time scanning is disabled.

```yaml
Type: String[]
Parameter Sets: SetExclusionSettingsByName, SetExclusionSettingsByValue
Aliases: ExcludedFilePaths, ExcludeFilePaths

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -ExcludeFileType

Specify an array of file types to exclude from scheduled and real-time scanning.

```yaml
Type: String[]
Parameter Sets: SetExclusionSettingsByName, SetExclusionSettingsByValue
Aliases: ExcludedFileTypes, ExcludeFileTypes

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -ExcludeProcess

Specify an array of processes for which any files opened by any of the processes are excluded from scheduled and real-time scanning.
The process itself is not excluded.

```yaml
Type: String[]
Parameter Sets: SetExclusionSettingsByName, SetExclusionSettingsByValue
Aliases: ExcludedProcesses, ExcludeProcesses

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -ExtendedCloudCheckSec

Specify the number of seconds to allow an extended check with the Cloud Protection Service to block and scan suspicious files.

```yaml
Type: Int32
Parameter Sets: SetMAPSSettingsByName, SetMAPSSettingsByValue
Aliases:

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -FallbackOrder

Define which security intelligence update sources the client uses, and the order in which it contacts them.

```yaml
Type: FallbackOrderType[]
Parameter Sets: SetDefinitionUpdatesSettingsByName, SetDefinitionUpdatesSettingsByValue
Aliases:
Accepted values: UpdatesDistributedFromConfigurationManager, UpdatesFromUncFileShares, UpdatesDistributedFromWsus, UpdatesDistributedFromMicrosoftUpdate, UpdatesDistributedFromMicrosoftMalwareProtectionCenter

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -FallbackToAlternateSourceHr

If you use Configuration Manager as a source for security intelligence updates, clients will only update from alternative sources if security intelligence is older than the number of hours that you specify with this value.

```yaml
Type: Int32
Parameter Sets: SetDefinitionUpdatesSettingsByName, SetDefinitionUpdatesSettingsByValue
Aliases: AuGracePeriod, FallbackToAlternateSourceHour

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -ForceWildcardHandling

This parameter processes wildcard characters and may lead to unexpected behavior (not recommended). You can't combine it with **DisableWildcardHandling**.

```yaml
Type: SwitchParameter
Parameter Sets: (All)
Aliases:

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -FullScanNetworkDrive

Set this parameter to `$true` to scan mapped network drives when running a full scan.

```yaml
Type: Boolean
Parameter Sets: SetScanSettingsByName, SetScanSettingsByValue
Aliases: FullScanNetworkDrives

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -InputObject

Specify an antimalware policy object to configure. To get this object, use the [Get-CMAntiMalwarePolicy](Get-CMAntiMalwarePolicy.md) cmdlet.

```yaml
Type: IResultObject
Parameter Sets: SetDefinitionUpdatesSettingsByValue, SetExclusionSettingsByValue, SetThreatOverridesSettingsByValue, SetScanSettingsByValue, SetRealtimeProtectionSettingsByValue, SetAdvancedSettingsByValue, SetMAPSSettingsByValue, SetScheduledScanSettingsByValue, SetDefaultActionSettingsByValue, SetByValue
Aliases: AntiMalwarePolicy

Required: True
Position: Named
Default value: None
Accept pipeline input: True (ByValue)
Accept wildcard characters: False
```

### -JoinSpyNet

Specify the Cloud Protection Service membership type.

- `DoNotJoinMaps`: No information is sent.
- `BasicMembership`: Collect and send lists of detected malware.
- `AdvancedMembership`: Basic information and more comprehensive information that could contain personal information. For example, file paths and partial memory dumps.

```yaml
Type: JoinSpyNetType
Parameter Sets: SetMAPSSettingsByName, SetMAPSSettingsByValue
Aliases:
Accepted values: DoNotJoinMaps, BasicMembership, AdvancedMembership

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -LimitCpuUsage

Specify the percentage to limit CPU usage during scans.

```yaml
Type: Int32
Parameter Sets: SetScheduledScanSettingsByName, SetScheduledScanSettingsByValue
Aliases:
Accepted values: 0, 10, 20, 30, 40, 50, 60, 70, 80, 90

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -MonitorFileProgramActivity

Set this parameter to `$true` to monitor file and program activity on the client computer.

```yaml
Type: Boolean
Parameter Sets: SetRealtimeProtectionSettingsByName, SetRealtimeProtectionSettingsByValue
Aliases:

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -Name

Specify the name of an antimalware policy to configure.

```yaml
Type: String
Parameter Sets: SetByName, SetDefinitionUpdatesSettingsByName, SetExclusionSettingsByName, SetThreatOverridesSettingsByName, SetScanSettingsByName, SetRealtimeProtectionSettingsByName, SetAdvancedSettingsByName, SetMAPSSettingsByName, SetScheduledScanSettingsByName, SetDefaultActionSettingsByName
Aliases:

Required: True
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -NetworkExploitProtection

Set this parameter to `$true` to enable protection against network-based exploits.

```yaml
Type: Boolean
Parameter Sets: SetRealtimeProtectionSettingsByName, SetRealtimeProtectionSettingsByValue
Aliases: NetworkProtectionAgainstExploits

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -NewName

Use this parameter to rename the policy that you specify with either the **Name** or **InputObject** parameters.

```yaml
Type: String
Parameter Sets: SetByName, SetByValue
Aliases:

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -OverrideAction

Specify the threat override action.
Use this parameter with the **ThreatName** parameter to configure threat override settings.

```yaml
Type: DefaultActionMediumAndLowType[]
Parameter Sets: SetThreatOverridesSettingsByName, SetThreatOverridesSettingsByValue
Aliases: OverrideActions
Accepted values: None, Quarantine, Remove, Allow

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -PassThru

Add this parameter to return an object that represents the item with which you're working. By default, this cmdlet may not generate any output.

```yaml
Type: SwitchParameter
Parameter Sets: (All)
Aliases:

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -Priority

Use this parameter to change the priority of the antimalware policy.

```yaml
Type: PriorityChangeType
Parameter Sets: SetByName, SetByValue
Aliases:
Accepted values: Increase, Decrease

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -PuaProtection

Starting in version 2107, use this parameter to configure detection for potentially unwanted applications (PUA). Specify one of the following values: `Disable`, `Enable`, or `Audit`

```yaml
Type: PuaProtection
Parameter Sets: SetRealtimeProtectionSettingsByName, SetRealtimeProtectionSettingsByValue
Aliases:
Accepted values: Disable, Enable, Audit

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -QuickScanTime

Specify a datetime object for when to do a daily quick scan. To get this object, use the [Get-Date](/powershell/module/microsoft.powershell.utility/get-date) built-in cmdlet.

```yaml
Type: DateTime
Parameter Sets: SetScheduledScanSettingsByName, SetScheduledScanSettingsByValue
Aliases: ScheduledScanQuickTime

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -RandomizeScheduledScanStartTime

Set this parameter to `$true` to randomize scheduled scan and security intelligence update start times.

```yaml
Type: Boolean
Parameter Sets: SetAdvancedSettingsByName, SetAdvancedSettingsByValue
Aliases:

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -RealTimeProtectionOn

Set this parameter to `$true` to enable real-time protection.

```yaml
Type: Boolean
Parameter Sets: SetRealtimeProtectionSettingsByName, SetRealtimeProtectionSettingsByValue
Aliases:

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -RealTimeScanOption

Specify how real-time protection scans system files. For performance reasons, you might have to change the default value if a server has high incoming or outgoing file activity.

```yaml
Type: RealTimeScanOptionType
Parameter Sets: SetRealtimeProtectionSettingsByName, SetRealtimeProtectionSettingsByValue
Aliases:
Accepted values: ScanIncomingAndOutgoingFiles, ScanIncomingFilesOnly, ScanOutgoingFilesOnly

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -RemoveDefinitionUpdateFileShare

Specify the network file share paths to remove from the list. To clear the entire list, use the **CleanDefinitionUpdateFileShare** parameter.

```yaml
Type: String[]
Parameter Sets: SetDefinitionUpdatesSettingsByName, SetDefinitionUpdatesSettingsByValue
Aliases: RemoveDefinitionUpdateFileSharesSources, RemoveDefinitionUpdateFileShares

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -RemoveExcludedFilePath

Specify the excluded file paths to remove from the list. To clear the entire list, use the **CleanExcludedFilePath** parameter.

```yaml
Type: String[]
Parameter Sets: SetExclusionSettingsByName, SetExclusionSettingsByValue
Aliases: RemoveExcludedFilePaths

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -RemoveExcludedFileType

Specify the excluded file types to remove from the list. To clear the entire list, use the **CleanExcludedFileType** parameter.

```yaml
Type: String[]
Parameter Sets: SetExclusionSettingsByName, SetExclusionSettingsByValue
Aliases: RemoveExcludedFileTypes

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -RemoveExcludedProcess

Specify the excluded processes to remove from the list. To clear the entire list, use the **CleanExcludedProcesses** parameter.

```yaml
Type: String[]
Parameter Sets: SetExclusionSettingsByName, SetExclusionSettingsByValue
Aliases: RemoveExcludedProcesses

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -RemoveThreat

Specify the names of threats to remove from the threat override table.

```yaml
Type: String[]
Parameter Sets: SetThreatOverridesSettingsByName, SetThreatOverridesSettingsByValue
Aliases: RemoveThreats, RemoveThreatsByName

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -ScanAllDownloaded

Set this parameter to `$true` to scan all downloaded files and enable exploit protection for the browser.

```yaml
Type: Boolean
Parameter Sets: SetRealtimeProtectionSettingsByName, SetRealtimeProtectionSettingsByValue
Aliases:

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -ScanArchive

Set this parameter to `$true` to scan archived files, for example `.zip` or `.cab` files.

```yaml
Type: Boolean
Parameter Sets: SetScanSettingsByName, SetScanSettingsByValue
Aliases: ScanArchivedFiles

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -ScanEmail

Set this parameter to `$true` to scan email and email attachments.

```yaml
Type: Boolean
Parameter Sets: SetScanSettingsByName, SetScanSettingsByValue
Aliases:

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -ScanNetworkDrive

Set this parameter to `$true` to scan network files.

```yaml
Type: Boolean
Parameter Sets: SetScanSettingsByName, SetScanSettingsByValue
Aliases: ScanNetworkDrives

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -ScanRemovableStorage

Set this parameter to `$true` to scan removable storage devices such as USB drives.

```yaml
Type: Boolean
Parameter Sets: SetScanSettingsByName, SetScanSettingsByValue
Aliases:

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -ScanWhenClientNotInUse

Set this parameter to `$true` to start a scheduled scan only when the computer is idle.

```yaml
Type: Boolean
Parameter Sets: SetScheduledScanSettingsByName, SetScheduledScanSettingsByValue
Aliases:

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -ScheduledScanTime

Specify a datetime object for when to do a scheduled scan. To get this object, use the [Get-Date](/powershell/module/microsoft.powershell.utility/get-date) built-in cmdlet.

```yaml
Type: DateTime
Parameter Sets: SetScheduledScanSettingsByName, SetScheduledScanSettingsByValue
Aliases:

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -ScheduledScanType

Specify the type of a scheduled scan.

- `QuickScan`: This type of scan checks the in-memory processes and folders where malware is typically found. It requires fewer resources than a full scan.

- `FullScan`: This type of scan adds a full check of all local files and folders to the items scanned in the quick scan. This scan takes longer than a quick scan and uses more CPU processing and memory resources on client computers.

In most cases, use **Quick scan** to minimize the use of system resources on client computers. If malware removal requires a full scan, endpoint protection generates an alert that's displayed in the Configuration Manager console. The default value is **Quick scan**.

```yaml
Type: ScheduledScanType
Parameter Sets: SetScheduledScanSettingsByName, SetScheduledScanSettingsByValue
Aliases:
Accepted values: None, QuickScan, FullScan

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -ScheduledScanUserControl

Specify the user control of scheduled scans.

```yaml
Type: ScheduledScanUserControlType
Parameter Sets: SetScanSettingsByName, SetScanSettingsByValue
Aliases:
Accepted values: NoControl, ScanTimeOnly, FullControl

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -ScheduledScanWeekday

Specify the day of the week when a scheduled scan runs.

```yaml
Type: ScheduledScanWeekdayType
Parameter Sets: SetScheduledScanSettingsByName, SetScheduledScanSettingsByValue
Aliases:
Accepted values: Daily, Sunday, Monday, Tuesday, Wednesday, Thursday, Friday, Saturday

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -ShowNotification

Set this parameter to `$true` to show notifications on the client computer when the user needs to run a full scan, update security intelligence, or run Windows Defender Offline.

```yaml
Type: Boolean
Parameter Sets: SetAdvancedSettingsByName, SetAdvancedSettingsByValue
Aliases: ShowNotificationMessages

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -SignatureUpdateHr

Specify the interval of hours between checks for security intelligence updates. Use an integer value up to 24, for example:

- `0`: Disable check on interval
- `1`: Check for updates every hour
- `24`: Check once per day

```yaml
Type: Int32
Parameter Sets: SetDefinitionUpdatesSettingsByName, SetDefinitionUpdatesSettingsByValue
Aliases: SignatureUpdateInterval, SignatureUpdateIntervalHour

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -SignatureUpdateTime

Specify a datetime object for when the client checks for security intelligence updates each day. To get this object, use the [Get-Date](/powershell/module/microsoft.powershell.utility/get-date) built-in cmdlet.

This setting only applies if you disable interval-based checks with `-SignatureUpdateHr 0`.

```yaml
Type: DateTime
Parameter Sets: SetDefinitionUpdatesSettingsByName, SetDefinitionUpdatesSettingsByValue
Aliases:

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -ThreatName

Specify the name of a threat.
Use this parameter with the **OverrideAction** parameter to configure threat override settings.

```yaml
Type: String[]
Parameter Sets: SetThreatOverridesSettingsByName, SetThreatOverridesSettingsByValue
Aliases: ThreatNames

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -UseBehaviorMonitor

Set this parameter to `$true` to enable behavior monitoring.

```yaml
Type: Boolean
Parameter Sets: SetRealtimeProtectionSettingsByName, SetRealtimeProtectionSettingsByValue
Aliases:

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -Confirm
Prompts you for confirmation before running the cmdlet.

```yaml
Type: SwitchParameter
Parameter Sets: (All)
Aliases: cf

Required: False
Position: Named
Default value: False
Accept pipeline input: False
Accept wildcard characters: False
```

### -WhatIf

Shows what would happen if the cmdlet runs. The cmdlet doesn't run.

```yaml
Type: SwitchParameter
Parameter Sets: (All)
Aliases: wi

Required: False
Position: Named
Default value: False
Accept pipeline input: False
Accept wildcard characters: False
```

### CommonParameters
This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable. For more information, see [about_CommonParameters](http://go.microsoft.com/fwlink/?LinkID=113216).

## INPUTS

### Microsoft.ConfigurationManagement.ManagementProvider.IResultObject
## OUTPUTS

### System.Object
## NOTES

## RELATED LINKS

[Export-CMAntimalwarePolicy](Export-CMAntimalwarePolicy.md)

[Get-CMAntiMalwarePolicy](Get-CMAntiMalwarePolicy.md)

[Import-CMAntimalwarePolicy](Import-CMAntimalwarePolicy.md)

[Merge-CMAntimalwarePolicy](Merge-CMAntimalwarePolicy.md)

[New-CMAntimalwarePolicy](New-CMAntimalwarePolicy.md)

[Remove-CMAntiMalwarePolicy](Remove-CMAntiMalwarePolicy.md)

[New-CMAntimalwarePolicyDeployment](New-CMAntimalwarePolicyDeployment.md)
